{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container py-4">
    <div class="text-center mb-4">
        <h1 class="display-5 fw-bold">AI Humanizer</h1>
        <p class="lead text-muted">Transform AI-generated text into natural, human-sounding writing</p>
    </div>

    {% csrf_token %}

    <div x-data="humanizer()" x-cloak>
        <!-- Mode Toggle -->
        <div class="row justify-content-center mb-3">
            <div class="col-lg-10">
                <div class="d-flex justify-content-center">
                    <div class="btn-group" role="group">
                        <button
                            type="button"
                            class="btn px-4"
                            :class="mode === 'basic' ? 'btn-primary' : 'btn-outline-primary'"
                            @click="mode = 'basic'"
                        >
                            Basic <span class="badge bg-light text-primary ms-1">Free</span>
                        </button>
                        <button
                            type="button"
                            class="btn px-4"
                            :class="mode === 'advanced' ? 'btn-primary' : 'btn-outline-primary'"
                            @click="mode = 'advanced'"
                        >
                            Advanced
                            {% if not is_premium %}
                            <span class="badge bg-warning text-dark ms-1">Premium</span>
                            {% endif %}
                        </button>
                    </div>
                </div>
                <p class="text-center text-muted small mt-2" x-text="mode === 'basic' ? 'Light touch - fixes obvious AI patterns while keeping your text close to the original' : 'Deep rewrite - varying sentence structure, adding personal touches, natural flow'"></p>
            </div>
        </div>

        <!-- Split Pane -->
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="row g-3">
                    <!-- Input -->
                    <div class="col-md-6">
                        <div class="card shadow-sm h-100">
                            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                <span class="fw-semibold">Original Text</span>
                                <small class="text-muted">
                                    <span x-text="wordCount"></span> words
                                    {% if not is_premium %}
                                    <span class="text-muted">/ 500 max</span>
                                    {% endif %}
                                </small>
                            </div>
                            <div class="card-body p-0">
                                <textarea
                                    class="form-control border-0"
                                    rows="14"
                                    x-model="inputText"
                                    @input="updateWordCount()"
                                    placeholder="Paste your AI-generated text here..."
                                    style="resize: none; font-size: 15px; line-height: 1.7; border-radius: 0 0 0.375rem 0.375rem;"
                                ></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Output -->
                    <div class="col-md-6">
                        <div class="card shadow-sm h-100">
                            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                <span class="fw-semibold">Humanized Text</span>
                                <button
                                    class="btn btn-sm btn-outline-secondary"
                                    @click="copyOutput()"
                                    x-show="outputText.length > 0"
                                    :title="copied ? 'Copied!' : 'Copy to clipboard'"
                                >
                                    <span x-show="!copied">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16"><path d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H6zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1H2z"/></svg>
                                        Copy
                                    </span>
                                    <span x-show="copied">Copied!</span>
                                </button>
                            </div>
                            <div class="card-body" style="min-height: 320px;">
                                <div x-show="!outputText && !loading" class="text-muted text-center py-5">
                                    <p>Humanized text will appear here</p>
                                </div>
                                <div x-show="loading" class="text-center py-5">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Humanizing...</span>
                                    </div>
                                    <p class="text-muted mt-2">Humanizing your text...</p>
                                </div>
                                <div x-show="outputText && !loading" style="font-size: 15px; line-height: 1.7; white-space: pre-wrap;" x-text="outputText"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Bar -->
        <div class="row justify-content-center mt-3">
            <div class="col-lg-10">
                <div class="d-flex justify-content-between align-items-center">
                    <button
                        class="btn btn-primary btn-lg px-5"
                        @click="humanize()"
                        :disabled="loading || wordCount === 0"
                    >
                        <span x-show="!loading">Humanize</span>
                        <span x-show="loading">
                            <span class="spinner-border spinner-border-sm me-1" role="status"></span>
                            Processing...
                        </span>
                    </button>
                    <button
                        class="btn btn-outline-secondary"
                        @click="clearAll()"
                        x-show="inputText.length > 0"
                    >Clear</button>
                </div>

                <!-- Error -->
                <div x-show="error" class="alert alert-danger mt-3 mb-0" x-text="error"></div>
            </div>
        </div>

        <!-- AI Score Comparison -->
        <div x-show="hasResults" class="row justify-content-center mt-4">
            <div class="col-lg-10">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="fw-semibold text-center mb-4">AI Detection Score</h5>
                        <div class="row text-center">
                            <div class="col-md-5">
                                <div class="position-relative d-inline-block" style="width: 130px; height: 130px;">
                                    <svg viewBox="0 0 120 120" class="w-100 h-100">
                                        <circle cx="60" cy="60" r="50" fill="none" stroke="#e9ecef" stroke-width="10"
                                            stroke-dasharray="235.6" stroke-dashoffset="0"
                                            transform="rotate(-90 60 60)" stroke-linecap="round"/>
                                        <circle cx="60" cy="60" r="50" fill="none"
                                            :stroke="getScoreColor(aiScoreBefore)" stroke-width="10"
                                            stroke-dasharray="235.6"
                                            :stroke-dashoffset="235.6 - (235.6 * (aiScoreBefore / 100))"
                                            transform="rotate(-90 60 60)" stroke-linecap="round"
                                            style="transition: stroke-dashoffset 1s ease-in-out;"/>
                                    </svg>
                                    <div class="position-absolute top-50 start-50 translate-middle text-center">
                                        <span class="fs-3 fw-bold" :style="'color:' + getScoreColor(aiScoreBefore)" x-text="aiScoreBefore + '%'"></span>
                                    </div>
                                </div>
                                <p class="text-muted mt-2">Before</p>
                            </div>
                            <div class="col-md-2 d-flex align-items-center justify-content-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="text-primary" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
                                </svg>
                            </div>
                            <div class="col-md-5">
                                <div class="position-relative d-inline-block" style="width: 130px; height: 130px;">
                                    <svg viewBox="0 0 120 120" class="w-100 h-100">
                                        <circle cx="60" cy="60" r="50" fill="none" stroke="#e9ecef" stroke-width="10"
                                            stroke-dasharray="235.6" stroke-dashoffset="0"
                                            transform="rotate(-90 60 60)" stroke-linecap="round"/>
                                        <circle cx="60" cy="60" r="50" fill="none"
                                            :stroke="getScoreColor(aiScoreAfter)" stroke-width="10"
                                            stroke-dasharray="235.6"
                                            :stroke-dashoffset="235.6 - (235.6 * (aiScoreAfter / 100))"
                                            transform="rotate(-90 60 60)" stroke-linecap="round"
                                            style="transition: stroke-dashoffset 1s ease-in-out;"/>
                                    </svg>
                                    <div class="position-absolute top-50 start-50 translate-middle text-center">
                                        <span class="fs-3 fw-bold" :style="'color:' + getScoreColor(aiScoreAfter)" x-text="aiScoreAfter + '%'"></span>
                                    </div>
                                </div>
                                <p class="text-muted mt-2">After</p>
                            </div>
                        </div>
                        <div class="text-center mt-2">
                            <span class="badge bg-success fs-6 px-3 py-2" x-show="aiScoreBefore - aiScoreAfter > 0">
                                <span x-text="Math.round(aiScoreBefore - aiScoreAfter)"></span>% reduction in AI detection
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Why Use Section -->
<div class="bg-light py-5">
    <div class="container">
        <h2 class="text-center fw-bold mb-5">Why Use Our AI Humanizer</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm p-4">
                    <h5 class="fw-semibold mb-3">Two Humanization Modes</h5>
                    <p class="text-muted mb-0">Basic mode lightly adjusts obvious AI patterns while keeping your text close to the original. Advanced mode (Premium) performs a deep rewrite with varied sentence structure and natural flow.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm p-4">
                    <h5 class="fw-semibold mb-3">AI Score Comparison</h5>
                    <p class="text-muted mb-0">See your AI detection score before and after humanization with visual gauges. Track exactly how much your text's AI probability dropped.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm p-4">
                    <h5 class="fw-semibold mb-3">Preserve Meaning</h5>
                    <p class="text-muted mb-0">Our AI humanizer rewrites text to sound natural while maintaining the original meaning, facts, and key arguments.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- How to Use Section -->
<div class="container py-5">
    <h2 class="text-center fw-bold mb-5">How to Use AI Humanizer</h2>
    <div class="row g-4 justify-content-center">
        <div class="col-md-4 text-center">
            <div class="rounded-circle bg-primary text-white d-inline-flex align-items-center justify-content-center mb-3" style="width:48px;height:48px;font-size:1.25rem;font-weight:700;">1</div>
            <h5 class="fw-semibold">Paste AI-Generated Text</h5>
            <p class="text-muted">Enter the AI-generated text you want to humanize in the left panel.</p>
        </div>
        <div class="col-md-4 text-center">
            <div class="rounded-circle bg-primary text-white d-inline-flex align-items-center justify-content-center mb-3" style="width:48px;height:48px;font-size:1.25rem;font-weight:700;">2</div>
            <h5 class="fw-semibold">Select Mode</h5>
            <p class="text-muted">Choose Basic (free, light touch) or Advanced (Premium, deep rewrite) depending on how thoroughly you want the text transformed.</p>
        </div>
        <div class="col-md-4 text-center">
            <div class="rounded-circle bg-primary text-white d-inline-flex align-items-center justify-content-center mb-3" style="width:48px;height:48px;font-size:1.25rem;font-weight:700;">3</div>
            <h5 class="fw-semibold">Humanize & Compare</h5>
            <p class="text-muted">Click Humanize to transform your text. Compare the AI detection scores before and after to see the reduction.</p>
        </div>
    </div>
</div>

<!-- FAQ Section -->
<div class="container py-5">
    <h2 class="text-center fw-bold mb-5">Frequently Asked Questions</h2>
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="accordion" id="faqAccordion">
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                            What is the difference between Basic and Advanced mode?
                        </button>
                    </h3>
                    <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Basic mode makes light adjustments to fix obvious AI patterns like repetitive sentence structures and generic phrasing, keeping your text close to the original. Advanced mode performs a deeper rewrite, varying sentence length, adding personal touches, and creating more natural flow. Advanced mode typically achieves greater AI score reduction.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                            Will my text still make sense after humanization?
                        </button>
                    </h3>
                    <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Yes. Both modes are designed to preserve the original meaning, facts, and key arguments of your text. The AI rewriter changes how ideas are expressed without altering what is being said.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                            How much does it reduce the AI score?
                        </button>
                    </h3>
                    <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Results vary depending on the input text and mode selected. Basic mode typically reduces AI detection scores by 20-40 percentage points. Advanced mode can achieve reductions of 50-80 percentage points, often bringing text into the human-written range.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                            What is the word limit?
                        </button>
                    </h3>
                    <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Free users can humanize up to 500 words per request using Basic mode. Premium subscribers get extended word limits and access to Advanced mode.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq5">
                            Can I use this for academic work?
                        </button>
                    </h3>
                    <div id="faq5" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            You should always follow your institution's academic integrity policies. While the humanizer can help improve the naturalness of AI-assisted writing, submitting AI-generated work as entirely your own may violate academic honesty policies.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq6">
                            Does it work with any AI-generated text?
                        </button>
                    </h3>
                    <div id="faq6" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Yes, the humanizer works with text generated by ChatGPT, GPT-4, Claude, Gemini, Jasper, and any other AI language model. It identifies and transforms common AI writing patterns regardless of the source.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq7">
                            Is Advanced mode worth upgrading for?
                        </button>
                    </h3>
                    <div id="faq7" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            If you need significant AI score reduction, Advanced mode is much more effective than Basic. It creates more varied sentence structures, adds conversational elements, and produces text that reads more naturally. Premium subscribers also get higher word limits.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq8">
                            How does the AI Score Comparison work?
                        </button>
                    </h3>
                    <div id="faq8" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            After humanization, we run the output through our AI detector to measure the AI probability before and after. The visual gauges show both scores and the percentage reduction, so you can see exactly how effective the humanization was.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq9">
                            Will the humanized text pass all AI detectors?
                        </button>
                    </h3>
                    <div id="faq9" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            While our humanizer is very effective, no tool can guarantee a 0% score on every AI detector. Different detectors use different methods, and results may vary. Our tool is designed to make text read naturally and reduce detection scores significantly.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq10">
                            Is my text stored after humanization?
                        </button>
                    </h3>
                    <div id="faq10" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            No. Your text is processed and returned to your browser immediately. We do not store, share, or use your input or output text for any purpose.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq11">
                            Can I humanize text in other languages?
                        </button>
                    </h3>
                    <div id="faq11" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            The humanizer is optimized for English text. Results may be unpredictable for other languages, as AI writing patterns vary across languages.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq12">
                            How long does humanization take?
                        </button>
                    </h3>
                    <div id="faq12" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Most requests are processed in 5-15 seconds, depending on the text length and selected mode. Advanced mode may take slightly longer due to the deeper analysis and rewriting involved.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/humanizer.js' %}?v={{ g.scripts_version }}"></script>
{% endblock %}
