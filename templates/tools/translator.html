{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container py-4">
    <div class="text-center mb-4">
        <h1 class="display-5 fw-bold">Translator</h1>
        <p class="lead text-muted">Translate text between 60+ languages instantly</p>
    </div>

    {% csrf_token %}

    <div x-data='translator({{ languages_json|safe }}, "auto", "es")'>
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <!-- Language Selection Bar -->
                <div class="card shadow-sm mb-0" style="border-bottom: 0; border-radius: 0.375rem 0.375rem 0 0;">
                    <div class="card-body py-2">
                        <div class="row align-items-center">
                            <div class="col-5">
                                <select
                                    class="form-select form-select-sm border-0 fw-semibold"
                                    x-model="sourceLang"
                                    style="background-color: transparent;"
                                >
                                    <option value="auto">Auto-Detect</option>
                                    <template x-for="lang in languages" :key="'src-' + lang.code">
                                        <option :value="lang.code" x-text="lang.name"></option>
                                    </template>
                                </select>
                            </div>
                            <div class="col-2 text-center">
                                <button
                                    class="btn btn-sm btn-outline-secondary rounded-circle"
                                    @click="swapLanguages()"
                                    :disabled="sourceLang === 'auto'"
                                    title="Swap languages"
                                    style="width: 36px; height: 36px;"
                                >
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="col-5">
                                <select
                                    class="form-select form-select-sm border-0 fw-semibold"
                                    x-model="targetLang"
                                    style="background-color: transparent;"
                                >
                                    <option value="" disabled>Select language</option>
                                    <template x-for="lang in languages" :key="'tgt-' + lang.code">
                                        <option :value="lang.code" x-text="lang.name"></option>
                                    </template>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Split Pane -->
                <div class="row g-0">
                    <!-- Source -->
                    <div class="col-md-6">
                        <div class="card shadow-sm h-100" style="border-radius: 0 0 0 0.375rem; border-right: 0;">
                            <div class="card-body p-0 position-relative">
                                <textarea
                                    class="form-control border-0"
                                    rows="10"
                                    x-model="inputText"
                                    @input="updateCharCount()"
                                    placeholder="Enter text to translate..."
                                    style="resize: none; font-size: 15px; line-height: 1.7; border-radius: 0;"
                                ></textarea>
                                <button
                                    class="btn btn-sm btn-link text-muted position-absolute"
                                    style="top: 8px; right: 8px;"
                                    @click="clearInput()"
                                    x-show="inputText.length > 0"
                                    title="Clear"
                                >
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="card-footer bg-white d-flex justify-content-between align-items-center" style="border-radius: 0 0 0 0.375rem;">
                                <small class="text-muted">
                                    <span x-text="charCount"></span> characters
                                    {% if not is_premium %}
                                    <span class="text-muted">/ 5,000 max</span>
                                    {% endif %}
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- Target -->
                    <div class="col-md-6">
                        <div class="card shadow-sm h-100" style="border-radius: 0 0 0.375rem 0;">
                            <div class="card-body" style="min-height: 230px; border-radius: 0;">
                                <div x-show="!translatedText && !loading" class="text-muted text-center py-5">
                                    <p>Translation will appear here</p>
                                </div>
                                <div x-show="loading" class="text-center py-5">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Translating...</span>
                                    </div>
                                    <p class="text-muted mt-2">Translating...</p>
                                </div>
                                <div x-show="translatedText && !loading" style="font-size: 15px; line-height: 1.7; white-space: pre-wrap;" x-text="translatedText"></div>
                            </div>
                            <div class="card-footer bg-white d-flex justify-content-between align-items-center" style="border-radius: 0 0 0.375rem 0;">
                                <small class="text-muted" x-show="detectedLang">
                                    Detected: <span class="fw-semibold" x-text="getLanguageName(detectedLang)"></span>
                                </small>
                                <small x-show="!detectedLang">&nbsp;</small>
                                <button
                                    class="btn btn-sm btn-outline-secondary"
                                    @click="copyTranslation()"
                                    x-show="translatedText.length > 0"
                                    :title="copied ? 'Copied!' : 'Copy translation'"
                                >
                                    <span x-show="!copied">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16"><path d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H6zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1H2z"/></svg>
                                        Copy
                                    </span>
                                    <span x-show="copied">Copied!</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Bar -->
        <div class="row justify-content-center mt-3">
            <div class="col-lg-10">
                <div class="d-flex justify-content-between align-items-center">
                    <button
                        class="btn btn-primary btn-lg px-5"
                        @click="translate()"
                        :disabled="loading || charCount === 0 || !targetLang"
                    >
                        <span x-show="!loading">Translate</span>
                        <span x-show="loading">
                            <span class="spinner-border spinner-border-sm me-1" role="status"></span>
                            Translating...
                        </span>
                    </button>
                </div>

                <!-- Error -->
                <div x-show="error" class="alert alert-danger mt-3 mb-0" x-text="error"></div>
            </div>
        </div>
    </div>
</div>
    <!-- Supported Languages -->
    {% if language_links %}
    <div class="container py-5">
        <h2 class="text-center fw-bold mb-2">Supported Languages</h2>
        <p class="text-center text-muted mb-4">Click a language to see all available translation pairs</p>
        <div class="row g-2 justify-content-center">
            {% for lang in language_links %}
            <div class="col-6 col-md-4 col-lg-3 col-xl-2">
                <a href="{{ lang.url }}" class="d-block text-decoration-none text-dark p-2 rounded small border bg-white text-center" style="transition: background-color 0.15s;">
                    {{ lang.name }}
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

<!-- Why Use Section -->
<div class="bg-light py-5">
    <div class="container">
        <h2 class="text-center fw-bold mb-5">Why Use Our Translator</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm p-4">
                    <h5 class="fw-semibold mb-3">60+ Languages</h5>
                    <p class="text-muted mb-0">Translate between more than 60 languages instantly, including Spanish, French, German, Chinese, Japanese, Arabic, Hindi, Portuguese, and many more.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm p-4">
                    <h5 class="fw-semibold mb-3">Auto-Detect Language</h5>
                    <p class="text-muted mb-0">Not sure what language your text is in? Our translator automatically detects the source language so you can get a translation without guessing.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm p-4">
                    <h5 class="fw-semibold mb-3">Fast & Free</h5>
                    <p class="text-muted mb-0">Get instant translations with no registration required. Translate up to 5,000 characters for free, with unlimited access for Premium subscribers.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- How to Use Section -->
<div class="container py-5">
    <h2 class="text-center fw-bold mb-5">How to Use Translator</h2>
    <div class="row g-4 justify-content-center">
        <div class="col-md-4 text-center">
            <div class="rounded-circle bg-primary text-white d-inline-flex align-items-center justify-content-center mb-3" style="width:48px;height:48px;font-size:1.25rem;font-weight:700;">1</div>
            <h5 class="fw-semibold">Enter Your Text</h5>
            <p class="text-muted">Paste or type your text in the left panel. The source language is auto-detected, or you can select it manually.</p>
        </div>
        <div class="col-md-4 text-center">
            <div class="rounded-circle bg-primary text-white d-inline-flex align-items-center justify-content-center mb-3" style="width:48px;height:48px;font-size:1.25rem;font-weight:700;">2</div>
            <h5 class="fw-semibold">Select Target Language</h5>
            <p class="text-muted">Choose the language you want to translate to from over 60 available languages.</p>
        </div>
        <div class="col-md-4 text-center">
            <div class="rounded-circle bg-primary text-white d-inline-flex align-items-center justify-content-center mb-3" style="width:48px;height:48px;font-size:1.25rem;font-weight:700;">3</div>
            <h5 class="fw-semibold">Translate & Copy</h5>
            <p class="text-muted">Click Translate to get your translation instantly. Copy the result or swap languages for reverse translation.</p>
        </div>
    </div>
</div>

<!-- FAQ Section -->
<div class="container py-5">
    <h2 class="text-center fw-bold mb-5">Frequently Asked Questions</h2>
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="accordion" id="faqAccordion">
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                            How many languages are supported?
                        </button>
                    </h3>
                    <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Our translator supports over 60 languages, including all major world languages like English, Spanish, French, German, Chinese (Simplified and Traditional), Japanese, Korean, Arabic, Hindi, Portuguese, Russian, Italian, Dutch, and many more.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                            How accurate are the translations?
                        </button>
                    </h3>
                    <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Our translator uses advanced AI models to produce high-quality translations that capture the context and meaning of your text. While AI translation has improved dramatically, we recommend having important documents reviewed by a native speaker for professional or legal purposes.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                            What is the character limit?
                        </button>
                    </h3>
                    <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Free users can translate up to 5,000 characters per request. Premium subscribers get extended limits for longer documents.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                            Does it detect the source language automatically?
                        </button>
                    </h3>
                    <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Yes. When you select Auto-Detect as the source language, our AI identifies the language of your input text automatically. The detected language is displayed below the translation result.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq5">
                            Can I translate entire documents?
                        </button>
                    </h3>
                    <div id="faq5" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            The translator works with pasted text up to the character limit. For longer documents, you can translate sections at a time. We plan to add direct file upload support in the future.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq6">
                            Is it better than Google Translate?
                        </button>
                    </h3>
                    <div id="faq6" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Our translator uses AI models that often produce more natural-sounding and contextually accurate translations, especially for longer passages. The best choice depends on the language pair and content type.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq7">
                            Can I translate between any two languages?
                        </button>
                    </h3>
                    <div id="faq7" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Yes, you can translate between any combination of our supported languages, not just to or from English. For example, you can translate directly from Spanish to Japanese or French to Arabic.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq8">
                            Does it preserve formatting?
                        </button>
                    </h3>
                    <div id="faq8" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            The translator preserves line breaks and paragraph structure in your text. However, complex formatting like tables, bullet points, or HTML markup may not be maintained during translation.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq9">
                            Is the translation private?
                        </button>
                    </h3>
                    <div id="faq9" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Your text is processed securely and is not stored or used for training purposes. Translations are generated on our servers and returned to your browser immediately.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq10">
                            How fast are translations?
                        </button>
                    </h3>
                    <div id="faq10" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Most translations are completed in just a few seconds, depending on the length of your text and the language pair. Premium subscribers get priority processing for faster results.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq11">
                            Can I translate technical or specialized content?
                        </button>
                    </h3>
                    <div id="faq11" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Yes, the AI handles technical, medical, legal, and business terminology well. For best results with highly specialized content, review the translation and adjust any domain-specific terms that may need refinement.
                        </div>
                    </div>
                </div>
                <div class="accordion-item border-0 mb-2">
                    <h3 class="accordion-header">
                        <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#faq12">
                            Is the translator free?
                        </button>
                    </h3>
                    <div id="faq12" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body text-muted">
                            Yes, our translator is free to use with standard character limits. Premium subscribers get extended limits and priority processing. No registration is required for basic translations.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/translator.js' %}?v={{ g.scripts_version }}"></script>
{% endblock %}
