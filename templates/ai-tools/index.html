{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container-fluid px-4 py-4">

    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12 text-center">
            <h1 class="h2 fw-bold">AI Writing Tools</h1>
            <p class="text-muted">{{ total_tools }}+ free AI-powered writing generators for any type of content</p>
        </div>
    </div>

    <!-- Search -->
    <div class="row mb-4 justify-content-center" x-data="{ search: '' }">
        <div class="col-lg-6 col-md-8">
            <div class="input-group">
                <span class="input-group-text bg-white border-end-0">
                    <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
                </span>
                <input
                    type="text"
                    class="form-control border-start-0"
                    placeholder="Search tools... e.g., essay, email, blog"
                    x-model="search"
                    @input="filterTools(search)"
                >
            </div>
        </div>
    </div>

    <!-- Category Sections -->
    {% for category, tools in categories.items %}
    <div class="mb-5 tool-category" data-category="{{ category }}">
        <h2 class="h4 fw-bold mb-3 pb-2 border-bottom">{{ category }}</h2>
        <div class="row g-3">
            {% for tool in tools %}
            <div class="col-xl-3 col-lg-4 col-md-6 tool-card" data-name="{{ tool.name|lower }}" data-slug="{{ tool.slug }}">
                <a href="/ai-tools/{{ tool.slug }}/" class="text-decoration-none">
                    <div class="card h-100 shadow-sm border-0 hover-shadow transition-all">
                        <div class="card-body p-3">
                            <h5 class="card-title h6 fw-semibold text-dark mb-1">{{ tool.name }}</h5>
                            <p class="card-text small text-muted mb-0 line-clamp-2">{{ tool.description }}</p>
                        </div>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endfor %}

    <!-- No results message -->
    <div id="no-results" class="text-center py-5 d-none">
        <p class="text-muted h5">No tools found matching your search.</p>
    </div>

    <!-- CTA -->
    <div class="row mt-5 mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm bg-brand-50 text-center">
                <div class="card-body py-5">
                    <h3 class="fw-bold mb-2">Need Unlimited Access?</h3>
                    <p class="text-muted mb-3">Free users get 50 generations per day. Upgrade to Premium for unlimited access to all {{ total_tools }}+ tools.</p>
                    <a href="/pricing/" class="btn btn-primary btn-lg">View Plans</a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.hover-shadow:hover {
    box-shadow: 0 0.5rem 1rem rgba(0,0,0,.15) !important;
    transform: translateY(-2px);
}
.transition-all {
    transition: all 0.2s ease;
}
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}
</style>

<script>
function filterTools(query) {
    query = query.toLowerCase().trim();
    const cards = document.querySelectorAll('.tool-card');
    const categories = document.querySelectorAll('.tool-category');
    let anyVisible = false;

    cards.forEach(card => {
        const name = card.dataset.name || '';
        const slug = card.dataset.slug || '';
        const match = !query || name.includes(query) || slug.includes(query);
        card.style.display = match ? '' : 'none';
        if (match) anyVisible = true;
    });

    // Hide empty categories
    categories.forEach(cat => {
        const visibleCards = cat.querySelectorAll('.tool-card:not([style*="display: none"])');
        cat.style.display = visibleCards.length > 0 ? '' : 'none';
    });

    document.getElementById('no-results').classList.toggle('d-none', anyVisible);
}
</script>
{% endblock %}
