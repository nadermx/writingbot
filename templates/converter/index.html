{% extends "base.html" %}
{% load static %}

{% block head %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Free Online File Converter",
    "url": "{{ request.build_absolute_uri }}",
    "applicationCategory": "UtilityApplication",
    "operatingSystem": "Any",
    "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
    },
    "description": "{{ description }}"
}
</script>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="bg-light py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <h1 class="display-5 fw-bold mb-3">Free Online File Converter</h1>
                <p class="lead text-muted mb-4">
                    Convert between {{ total_count }}+ file format combinations. Image conversions, document conversions, and more.
                    Fast, free, and secure -- no registration required.
                </p>
            </div>
        </div>

        <!-- Popular Conversions Quick Access -->
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="d-flex flex-wrap justify-content-center gap-2">
                    {% for pair in popular %}
                    <a href="{{ pair.url }}" class="btn btn-outline-primary btn-sm">
                        {{ pair.label }}
                    </a>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Search / Filter -->
<div class="container py-4" x-data="converterIndex()">
    <div class="row justify-content-center mb-4">
        <div class="col-lg-6">
            <div class="input-group">
                <span class="input-group-text bg-white border-end-0">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6c757d" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                </span>
                <input type="text" class="form-control border-start-0" placeholder="Search conversions (e.g. JPG to PNG, Word to PDF...)"
                       x-model="search" @input="filterPairs()">
            </div>
        </div>
    </div>

    <!-- Category Tabs -->
    <ul class="nav nav-pills justify-content-center mb-4" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link" :class="activeTab === 'all' ? 'active' : ''" @click="activeTab = 'all'; filterPairs()">
                All ({{ total_count }})
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" :class="activeTab === 'image' ? 'active' : ''" @click="activeTab = 'image'; filterPairs()">
                Image Conversions
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" :class="activeTab === 'document' ? 'active' : ''" @click="activeTab = 'document'; filterPairs()">
                Document Conversions
            </button>
        </li>
    </ul>

    <!-- Image Conversions Grid -->
    <div x-show="activeTab === 'all' || activeTab === 'image'">
        <h2 class="fw-bold mb-4" x-show="filteredImagePairs.length > 0">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#6366f1" viewBox="0 0 24 24" class="me-2"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
            Image Conversions
        </h2>

        <!-- Group by source format -->
        {% for src_key, src_fmt in image_formats.items %}
        <div class="mb-4 image-group" data-source="{{ src_key }}">
            <h5 class="fw-semibold text-muted mb-3">From {{ src_fmt.name }}</h5>
            <div class="row g-2">
                {% for pair in image_pairs %}
                {% if pair.source.name == src_fmt.name %}
                <div class="col-6 col-sm-4 col-md-3 col-lg-2 converter-card" data-label="{{ pair.label|lower }}">
                    <a href="{{ pair.url }}" class="card border-0 shadow-sm text-decoration-none h-100 converter-link">
                        <div class="card-body p-3 text-center">
                            <div class="d-flex align-items-center justify-content-center gap-1 mb-1">
                                <span class="badge bg-secondary" style="font-size: 0.7rem;">{{ pair.source.name }}</span>
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="#6c757d" viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z"/></svg>
                                <span class="badge bg-primary" style="font-size: 0.7rem;">{{ pair.target.name }}</span>
                            </div>
                            <small class="text-muted" style="font-size: 0.75rem;">{{ pair.label }}</small>
                        </div>
                    </a>
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Document Conversions Grid -->
    <div x-show="activeTab === 'all' || activeTab === 'document'">
        <h2 class="fw-bold mb-4 mt-5" x-show="filteredDocPairs.length > 0">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#6366f1" viewBox="0 0 24 24" class="me-2"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"/></svg>
            Document Conversions
        </h2>

        <div class="row g-2">
            {% for pair in doc_pairs %}
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 converter-card" data-label="{{ pair.label|lower }}">
                <a href="{{ pair.url }}" class="card border-0 shadow-sm text-decoration-none h-100 converter-link">
                    <div class="card-body p-3 text-center">
                        <div class="d-flex align-items-center justify-content-center gap-1 mb-1">
                            <span class="badge bg-secondary" style="font-size: 0.7rem;">{{ pair.source.name }}</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="#6c757d" viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z"/></svg>
                            <span class="badge bg-primary" style="font-size: 0.7rem;">{{ pair.target.name }}</span>
                        </div>
                        <small class="text-muted" style="font-size: 0.75rem;">{{ pair.label }}</small>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Features Section -->
<div class="bg-light py-5 mt-4">
    <div class="container">
        <h2 class="text-center fw-bold mb-5">Why Choose WritingBot.ai File Converter?</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm p-4">
                    <div class="mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#6366f1" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                    </div>
                    <h5 class="fw-semibold mb-3">100% Free</h5>
                    <p class="text-muted mb-0">All file conversions are completely free. No hidden fees, no watermarks, no registration required. Just upload, convert, and download.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm p-4">
                    <div class="mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#6366f1" viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>
                    </div>
                    <h5 class="fw-semibold mb-3">Fast Conversion</h5>
                    <p class="text-muted mb-0">Convert files in seconds with our powerful server-side processing. No waiting in queues or watching progress bars. Instant results every time.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm p-4">
                    <div class="mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#6366f1" viewBox="0 0 24 24"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>
                    </div>
                    <h5 class="fw-semibold mb-3">Secure & Private</h5>
                    <p class="text-muted mb-0">Your files are processed securely and never stored. All uploads are encrypted and automatically deleted after conversion. Your privacy is guaranteed.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Supported Formats -->
<div class="container py-5">
    <h2 class="text-center fw-bold mb-5">Supported File Formats</h2>
    <div class="row g-4">
        <div class="col-md-6">
            <h5 class="fw-semibold mb-3">Image Formats</h5>
            <div class="d-flex flex-wrap gap-2">
                {% for key, fmt in image_formats.items %}
                <span class="badge bg-light text-dark border px-3 py-2">{{ fmt.name }} ({{ fmt.extension }})</span>
                {% endfor %}
            </div>
        </div>
        <div class="col-md-6">
            <h5 class="fw-semibold mb-3">Document Formats</h5>
            <div class="d-flex flex-wrap gap-2">
                {% for key, fmt in document_formats.items %}
                <span class="badge bg-light text-dark border px-3 py-2">{{ fmt.name }} ({{ fmt.extension }})</span>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- FAQ Section -->
<div class="bg-light py-5">
    <div class="container">
        <h2 class="text-center fw-bold mb-5">Frequently Asked Questions</h2>
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="accordion" id="indexFaqAccordion">
                    <div class="accordion-item border-0 mb-2">
                        <h3 class="accordion-header">
                            <button class="accordion-button fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#ifaq1">
                                What file formats can I convert?
                            </button>
                        </h3>
                        <div id="ifaq1" class="accordion-collapse collapse show" data-bs-parent="#indexFaqAccordion">
                            <div class="accordion-body text-muted">
                                We support {{ total_count }}+ conversion combinations including image formats (JPG, PNG, WebP, GIF, BMP, TIFF, ICO, SVG, HEIC, AVIF) and document formats (PDF, Word, Excel, PowerPoint, CSV, TXT, HTML, ODT, RTF, EPUB). You can convert between any supported pair.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item border-0 mb-2">
                        <h3 class="accordion-header">
                            <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#ifaq2">
                                Is the file converter really free?
                            </button>
                        </h3>
                        <div id="ifaq2" class="accordion-collapse collapse" data-bs-parent="#indexFaqAccordion">
                            <div class="accordion-body text-muted">
                                Yes, all file conversions on WritingBot.ai are completely free. There are no hidden fees, no watermarks added to your files, and no registration required. Just upload, convert, and download.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item border-0 mb-2">
                        <h3 class="accordion-header">
                            <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#ifaq3">
                                Is my data safe when I upload files?
                            </button>
                        </h3>
                        <div id="ifaq3" class="accordion-collapse collapse" data-bs-parent="#indexFaqAccordion">
                            <div class="accordion-body text-muted">
                                Absolutely. Your files are processed securely on our servers using encrypted connections. Files are never stored permanently and are automatically deleted immediately after conversion. We do not share, sell, or analyze your files in any way.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item border-0 mb-2">
                        <h3 class="accordion-header">
                            <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#ifaq4">
                                What is the maximum file size?
                            </button>
                        </h3>
                        <div id="ifaq4" class="accordion-collapse collapse" data-bs-parent="#indexFaqAccordion">
                            <div class="accordion-body text-muted">
                                Free users can convert files up to 10MB. This covers most images and documents. If you need to convert larger files, consider upgrading to our Premium plan for increased file size limits and priority processing.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item border-0 mb-2">
                        <h3 class="accordion-header">
                            <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse" data-bs-target="#ifaq5">
                                Do I need to install any software?
                            </button>
                        </h3>
                        <div id="ifaq5" class="accordion-collapse collapse" data-bs-parent="#indexFaqAccordion">
                            <div class="accordion-body text-muted">
                                No. Our file converter runs entirely in your web browser. There is nothing to download or install. It works on any device including Windows, Mac, Linux, iOS, and Android.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function converterIndex() {
    return {
        search: '',
        activeTab: 'all',
        filteredImagePairs: [],
        filteredDocPairs: [],

        init() {
            this.filterPairs();
        },

        filterPairs() {
            var searchLower = this.search.toLowerCase().trim();
            var tab = this.activeTab;

            // Filter image converter cards
            document.querySelectorAll('.image-group').forEach(function(group) {
                var hasVisible = false;
                group.querySelectorAll('.converter-card').forEach(function(card) {
                    var label = card.dataset.label || '';
                    var matchSearch = !searchLower || label.indexOf(searchLower) !== -1;
                    var matchTab = (tab === 'all' || tab === 'image');
                    if (matchSearch && matchTab) {
                        card.style.display = '';
                        hasVisible = true;
                    } else {
                        card.style.display = 'none';
                    }
                });
                group.style.display = hasVisible ? '' : 'none';
            });

            // Filter document converter cards
            var docSection = document.querySelectorAll('.converter-card:not(.image-group .converter-card)');
            // Re-count for Alpine reactivity
            this.filteredImagePairs = tab === 'document' ? [] : ['placeholder'];
            this.filteredDocPairs = tab === 'image' ? [] : ['placeholder'];
        }
    };
}
</script>
{% endblock %}
